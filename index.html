<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VayuSetu Portal</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        background: linear-gradient(135deg, #1a3a3a 0%, #0d1f2d 50%, #1a1a2e 100%);
        margin: 0;
        padding: 10px;
      }

      .container {
        background: white;
        padding: 35px;
        box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.4);
        border-radius: 10px;
        width: 100%;
        max-width: 450px;
        text-align: center;
        position: relative;
        border-top: 5px solid #c41e3a;
        border-left: 3px solid #c41e3a;
      }

      .container::before {
        content: "";
        position: absolute;
        top: -5px;
        left: -3px;
        right: 0;
        bottom: 0;
        border-radius: 10px;
        background: linear-gradient(135deg, #c41e3a, #2c5f7c);
        opacity: 0.1;
        z-index: -1;
      }

      .logo-container {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 20px;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid #ddd;
      }

      .logo-container img {
        width: 75px;
        height: 75px;
        object-fit: contain;
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
      }

      h2 {
        color: #c41e3a;
        margin-bottom: 5px;
        font-size: 28px;
        font-weight: bold;
        letter-spacing: 2px;
      }

      .portal-name {
        font-size: 16px;
        font-weight: bold;
        color: #2c5f7c;
        margin-bottom: 20px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .tabs {
        display: flex;
        gap: 8px;
        margin-bottom: 25px;
        border-bottom: 3px solid #c41e3a;
        padding-bottom: 0;
      }

      .tab-button {
        padding: 12px 16px;
        background: #f0f0f0;
        border: none;
        color: #555;
        font-weight: 600;
        cursor: pointer;
        font-size: 13px;
        border-bottom: 4px solid transparent;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .tab-button:hover {
        background: #e0e0e0;
      }

      .tab-button.active {
        color: white;
        background: linear-gradient(135deg, #c41e3a, #d63447);
        border-bottom-color: #c41e3a;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
        animation: fadeIn 0.3s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(5px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      p[style*="color: black"] {
        color: #2c5f7c !important;
        font-size: 15px;
        margin-bottom: 18px;
        letter-spacing: 0.5px;
      }

      input,
      select,
      button {
        width: 100%;
        padding: 13px;
        margin-top: 10px;
        border: 2px solid #ddd;
        border-radius: 5px;
        font-size: 14px;
        box-sizing: border-box;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        transition: all 0.3s ease;
      }

      input:focus,
      select:focus {
        outline: none;
        border-color: #c41e3a;
        box-shadow: 0 0 8px rgba(196, 30, 58, 0.2);
        background-color: #fafafa;
      }

      input::placeholder {
        color: #999;
      }

      select {
        appearance: none;
        background: white url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%23555'%3E%3Cpath d='M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z'/%3E%3C/svg%3E") no-repeat right 10px center;
        padding-right: 35px;
        background-size: 20px;
      }

      button {
        background: linear-gradient(135deg, #c41e3a, #d63447);
        color: white;
        border: none;
        font-size: 15px;
        cursor: pointer;
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 1px;
        box-shadow: 0 4px 8px rgba(196, 30, 58, 0.3);
      }

      button:hover {
        background: linear-gradient(135deg, #a81830, #c41e3a);
        box-shadow: 0 6px 12px rgba(196, 30, 58, 0.4);
        transform: translateY(-2px);
      }

      button:active {
        transform: translateY(0);
      }

      .message {
        margin-top: 12px;
        margin-bottom: 12px;
        font-size: 14px;
        font-weight: 600;
        padding: 10px;
        border-radius: 5px;
      }

      .success {
        color: #2e7d32;
        background-color: #e8f5e9;
        border-left: 4px solid #2e7d32;
      }

      .error {
        color: #c41e3a;
        background-color: #ffebee;
        border-left: 4px solid #c41e3a;
      }

      #attendanceTable {
        margin-top: 20px;
        overflow-x: auto;
      }

      #attendanceTable table {
        width: 100%;
        border-collapse: collapse;
        text-align: center;
        font-size: 14px;
      }

      #attendanceTable thead {
        background: linear-gradient(135deg, #c41e3a, #2c5f7c);
        color: white;
        font-weight: bold;
      }

      #attendanceTable th {
        padding: 12px;
        border: 1px solid #ddd;
        letter-spacing: 0.5px;
      }

      #attendanceTable td {
        border: 1px solid #ddd;
        padding: 10px;
      }

      #attendanceTable tbody tr:nth-child(even) {
        background-color: #f9f9f9;
      }

      #attendanceTable tbody tr:hover {
        background-color: #f0f0f0;
      }

      .footer {
        margin-top: 25px;
        text-align: center;
        color: #888;
        font-size: 12px;
        padding: 15px 0;
        border-top: 1px solid #ddd;
        letter-spacing: 0.5px;
      }

      @media (max-width: 480px) {
        .container {
          padding: 25px;
          max-width: 95%;
        }

        h2 {
          font-size: 24px;
        }

        .portal-name {
          font-size: 14px;
        }

        .tabs {
          flex-wrap: wrap;
        }

        .tab-button {
          padding: 10px 12px;
          font-size: 12px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="logo-container">
        <img src="./ncc-logo-png_seeklogo-440419.png" alt="NCC Logo" />
        <img src="./1das.jpg" alt="Unit Logo" />
      </div>

      <h2>VAYUSETU</h2>
      <div class="portal-name">1DAS EVENTS REGISTRATION PORTAL</div>

      <!-- Tab Navigation -->
      <div class="tabs">
        <button class="tab-button active" onclick="switchTab('attendance')">Attendance</button>
        <button class="tab-button" onclick="switchTab('event')">Event</button>
        <button class="tab-button" onclick="switchTab('viewAttendance')">Attendance Record</button>
      </div>

      <!-- Attendance Tab -->
      <div id="attendance" class="tab-content active">
        <p style="color: black;font-weight: 900;">MARK ATTENDANCE</p>
        <input
          list="regimentalNumbers2"
          id="regimentalNo2"
          placeholder="Regimental No"
          required
        />
        <datalist id="regimentalNumbers2"></datalist>

        <input list="ranks2" id="rank2" placeholder="Rank" required />
        <datalist id="ranks2"></datalist>

        <input list="names2" id="name2" placeholder="Name" required />
        <datalist id="names2"></datalist>

        <select id="year2">
          <option value="">Choose Year</option>
          <option value="2nd Year">2nd Year</option>
          <option value="3rd Year">3rd Year</option>
        </select>

        <select id="squadron2">
          <option value="">Choose Squadron</option>
          <option value="Aquino">Aquino</option>
          <option value="Brar">Brar</option>
          <option value="Chitnis">Chitnis</option>
          <option value="Katre">Katre</option>
        </select>

        <button onclick="submitForm('attendance')">Mark Attendance</button>
        <div id="message-attendance" class="message"></div>
      </div>

      <!-- Event Tab -->
      <div id="event" class="tab-content">
        <p style="color: black;font-weight: 900;">EVENT DETAILS</p>
        <input
          list="regimentalNumbers3"
          id="regimentalNo3"
          placeholder="Regimental No"
          required
        />
        <datalist id="regimentalNumbers3"></datalist>

        <input list="ranks3" id="rank3" placeholder="Rank" required />
        <datalist id="ranks3"></datalist>

        <input list="names3" id="name3" placeholder="Name" required />
        <datalist id="names3"></datalist>

        <select id="year3">
          <option value="">Choose Year</option>
          <option value="2nd Year">2nd Year</option>
          <option value="3rd Year">3rd Year</option>
        </select>

        <select id="squadron3">
          <option value="">Choose Squadron</option>
          <option value="Aquino">Aquino</option>
          <option value="Brar">Brar</option>
          <option value="Chitnis">Chitnis</option>
          <option value="Katre">Katre</option>
        </select>

        <select id="event3">
          <option value="">Choose Event</option>
          <option value="Drill Competition">Drill Competition</option>
          <option value="Sports Meet">Sports Meet</option>
          <option value="Rifle Shooting">Rifle Shooting</option>
          <option value="Field Training">Field Training</option>
          <option value="War Games">War Games</option>
          <option value="Parade">Parade</option>
          <option value="Leadership Course">Leadership Course</option>
          <option value="Adventure Activity">Adventure Activity</option>
        </select>

        <button onclick="submitForm('event')">Submit</button>
        <div id="message-event" class="message"></div>
      </div>

      <!-- Attendance Record Tab -->
      <div id="viewAttendance" class="tab-content">
        <p style="color: black;font-weight: 900;">ATTENDANCE RECORD</p>
        <input
          list="regimentalNumbers4"
          id="regimentalNo4"
          placeholder="Regimental No"
          required
        />
        <datalist id="regimentalNumbers4"></datalist>

        <input list="names4" id="name4" placeholder="Name" required />
        <datalist id="names4"></datalist>

        <button onclick="viewAttendanceRecord()">View Attendance</button>
        <div id="message-viewAttendance" class="message"></div>
        
        <div id="attendanceTable" style="margin-top: 20px; display: none;">
          <table style="width: 100%; border-collapse: collapse; text-align: center;">
            <thead>
              <tr style="background-color: #1976d2; color: white;">
                <th style="border: 1px solid #ddd; padding: 10px;">Date</th>
                <th style="border: 1px solid #ddd; padding: 10px;">Status</th>
                <th style="border: 1px solid #ddd; padding: 10px;">Event</th>
              </tr>
            </thead>
            <tbody id="attendanceBody">
            </tbody>
          </table>
        </div>
      </div>

      <div class="footer">&copy; Developed By Flt Cdt Milan Singh</div>
    </div>

    

    <script>
      // Sample Data for Dropdowns
      const regimentalNumbers = [];
      for (let i = 6542; i <= 6610; i++) {
        regimentalNumbers.push(`DL2023SDF00${i}`);
      }

      // Add Extra Regimental Numbers Manually (Outside the Range)
      const extraRegimentalNumbers = [
        "DL2024SDAF1280964", "DL2024SDAF1280642", "DL2024SDAF1280643", "DL2024SDAF1280644",
        "DL2024SDAF1280645", "DL2024SDAF1280646", "DL2024SDAF1280647", "DL2024SDAF1280648",
        "DL2024SDAF1280649", "DL2024SDAF1280650", "DL2024SDAF1280651", "DL2024SDAF1280960",
        "DL2024SDAF1280961", "DL2024SDAF1280962", "DL2024SDAF1280963", "DL2024SDAF1280965",
        "DL2024SDAF1280966", "DL2024SDAF1280967", "DL2024SDAF1280968", "DL2024SDAF1280969",
        "DL2024SDAF1280970", "DL2024SDAF1280971", "DL2024SDAF1280972", "DL2024SDAF1280973",
        "DL2024SDAF1280975", "DL2024SDAF1280979", "DL2024SDAF1280974", "DL2024SDAF1280590",
        "DL2024SDAF1280591", "DL2024SDAF1280592", "DL2024SDAF1280593", "DL2024SDAF1280594",
        "DL2024SDAF1280595", "DL2024SDAF1280596", "DL2024SDAF1280597", "DL2024SDAF1280598",
        "DL2024SDAF1280599", "DL2024SDAF1280600", "DL2024SDAF1280601", "DL2024SDAF1280602",
        "DL2024SDAF1280603", "DL2024SDAF1280604", "DL2024SDAF1280605", "DL2024SDAF1280606",
        "DL2024SDAF1280607", "DL2024SDAF1280608", "DL2024SDAF1280609", "DL2024SDAF1280610",
        "DL2024SDAF1280611", "DL2024SDAF1280612", "DL2024SDAF1280613", "DL2024SDAF1280615",
        "DL2024SDAF1280616", "DL2024SDAF1280617", "DL2024SDAF1280618", "DL2024SDAF1280619",
        "DL2024SDAF1280620", "DL2024SDAF1280621", "DL2024SDAF1280622", "DL2024SDAF1280623",
        "DL2024SDAF1280624", "DL2024SDAF1280625", "DL2024SDAF1280626", "DL2024SDAF1280627",
        "DL2024SDAF1280629", "DL2024SDAF1280631", "DL2024SDAF1280632", "DL2024SDAF1280633",
        "DL2024SDAF1280634", "DL2024SDAF1280635", "DL2024SDAF1280636", "DL2024SDAF1280637",
        "DL2024SDAF1280638", "DL2024SDAF1280639", "DL2024SDAF1280640", "DL2024SDAF1280641",
        "DL2024SDAF1280643", "DL2024SDAF1280942", "DL2024SDAF1280943", "DL2024SDAF1280944",
        "DL2024SDAF1280945", "DL2024SDAF1280946", "DL2024SDAF1280947", "DL2024SDAF1280948",
        "DL2024SDAF1280949", "DL2024SDAF1280950", "DL2024SDAF1280951", "DL2024SDAF1280952",
        "DL2024SDAF1280953", "DL2024SDAF1280954", "DL2024SDAF1280955", "DL2024SDAF1280956",
        "DL2024SDAF1280957", "DL2024SDAF1280958", "DL2024SDAF1280959"
];

      regimentalNumbers.push(...extraRegimentalNumbers); // Merge lists

      const ranks = ["FLT CDT", "CDT SGT", "CWO", "CUO", "CSUO"];
      const names = [
        "VIVEK YADAV", "RAGHAV SHARMA", "KRISHNA SANJAY BHELU", "NITISH KUMAR", "SOMVIR", 
        "PRITHVI RATHORE", "ANKIT LAMBA", "SUMIT", "RAUNAK KUMAR", "ANANT KUMAR DIXIT", 
        "ROCKY KUMAR JHA", "HARSH PHOGAT", "VIPUL DHANIA", "AJAY KUMAR", "SUDHANSHU GHULE", 
        "AYUSH THAKUR", "SUHAIL AHEMAD SAIFI", "NITEESH", "YASHRAJ", "ABHINAV SAXENA", 
        "MRADUL", "AYUSH KUMAR", "ASHISH KUMAR", "ANSHU SINGH", "VISHAL", "PAWAN MEHTO", 
        "PRIYANSHU JHA", "JYOTIRADITYA KISHOR", "SAGAR", "ABHISHEK KUMAR", "ROHIT KUMAR", 
        "UTTKARSH SINGH", "ANKIT SINGH", "AAYUSH SHARMA", "HARSH PRASAD", "ARYA KUMAR CHAUHAN", 
        "RITHIK PANWAR", "NAVIN KUMAR BHARDWAJ", "ARCHIT PANDEY", "DIWAKER", "AKASH KUMAR THAKUR", 
        "MUKESH MANDAL", "NIKHIL KUMAR", "NITIN", "MOHD ASHAR FAHEEM", "KISHAN KUMAR", 
        "MANAF FAROOQUI", "RAVI", "HARSH VARDHAN", "NIRBHAY TIWARI", "MOHIT PRATAP SHARMA", 
        "RAM SWAROOP", "HIMANSHU SHAKYA", "PRIYANSHU NEGI", "VIKAS YADAV", "NITIN JANGRA", 
        "GARV DOGRA", "SANDEEP CHAUHAN", "PRIYANSHU KUMAR", "NITIN KUMAR JAKHAR", "SAURABH", 
        "ANUJ KUMAR", "VAIBHAV", "DEVVRAT KHATRI", "CHANDAN KUMAR", "AYUSH KUMAR", "RAJEEV", 
        "PRANAV", "KAUSHAL", "CHETAN", "KUSH KUMAR PANDEY", "SOYAM CHOURASIA", "AVDHESH KUMAR PODDAR", 
        "GAGAN BHARDWAJ", "PIYUSH DUBEY", "SHIVAM OJHA", "RIPHIL KUMAR", "DEEPAK BAIRWA", "RAHUL", 
        "SHAH FAISAL BASHIR", "NEERAJ KUMAR", "SAHIL SHARMA", "ATUL SINGH", "MANAS KUMAR JHA", 
        "ANUJ SHAKYA", "VIKRAM SINGH RATHORE", "SANDEEP KUMAR YADAV", "SHREYASKOR BORGOHAIN", 
        "VIKAS KUMAR GUPTA", "BIMAL GORAI", "ABHINAV RAJ SINGH", "VAIBHAV KUMAR VERMA", 
        "PRASHANT KUMAR CHAUBEY", "SIDDHARTH PANDEY", "RAHUL SINGH CHAUHAN", "HIMANSHU SHARMA", 
        "SHIV NARAYAN SAHNI", "SANDEEP KUMAR", "ROHIT PANDEY","SANDEEP", "JATIN YADAV", "SUBHAJIT DAS", 
        "MD NASRULLAH ANSARI", "SANDEEP YADAV", "GOPAL KRISHNA", "SIMARJEET SINGH", 
        "MILAN SINGH", "PIYUSH PARMAR", "SAURABH YADAV", "KARTIK SAINI", "RISHABH RAJA", 
        "AMRINDER SINGH GREWAL", "ANIKET RAJ", "KARTIKAY SINGH JAGIRDAR", "ANUJ YADAV", 
        "ANUBHAV KUMAR SINGH", "ABHINANDAN KUMAR SINGH", "SHUBHAM SHARMA", "RAHUL CHAURSIA", 
        "ADITYA SIROHI", "SAMEER CHAUHAN", "PREM BHARDWAJ", "RAVADA PAWAN KUMAR", 
        "ABHISHEK MISHRA", "HARSHVARDHAN CHHETRI", "AALOK KUMAR", "RAHUL SINGH DUSAD", 
        "VISHU NAMDEV", "MADHUSUDAN SINGH LEGHA", "HARE KRISHNA NAIK", "SHIVAM TIWARI", 
        "PRIYANSHU THAKUR", "SAMARTH RANGAR", "PRASHANT AWASTHI", "RISHABH NEGI", 
        "PRATYUSH BHALLA", "TANISHK VERMA", "NITIN SHARMA", "DEEPU KUMAR", "ARPIT", 
        "SATYAM KUMAR", "SUJEET KUMAR YADAV", "PAWAN KUMAR SAH", "ARYAN SHARMA", 
        "HARSH RAJ SINGH", "VIVEK THAKUR", "RUDRAKSH SINGH", "ADITYA SINGH", 
        "VANSH GUPTA", "GOPAL TIWARI", "SANKALP CHOUDHARY", "JOYSURIYA BHATTACHARJEE", 
        "ARYAN SINGH", "ANANG SHASHWAT TARUN", "GARVIT SHARMA", "SAHIL MEHTA", "ARPIT YADAV", 
        "NAZIR UDDIN", "MOHMMAD FAIZ", "ABDULLAH", "JITENDRA SINGH",
        "DILAWAR KHAN", "GULKESH", "IMRAN ALAM", "DIVYANK", "HASSAN HASAN", "AFTAB ALI",
        "MUSHFIQUE DANYAL", "MANABHANJAN MAHANANDA", "MUHAMMED YAZID A H", "SHAKEEB ARSALAN M P",
        "AHMAD KHAN", "MASROOF ALAM", "GUFRAN KHAN"
      ];

      function populateDatalist(id, values) {
        const datalist = document.getElementById(id);
        datalist.innerHTML = ""; // Clear previous options
        values.forEach((value) => {
          const option = document.createElement("option");
          option.value = value;
          datalist.appendChild(option);
        });
      }

      // Populate datalists for all tabs on page load
      populateDatalist("regimentalNumbers2", regimentalNumbers);
      populateDatalist("regimentalNumbers3", regimentalNumbers);
      populateDatalist("regimentalNumbers4", regimentalNumbers);
      populateDatalist("ranks2", ranks);
      populateDatalist("ranks3", ranks);
      populateDatalist("names2", names);
      populateDatalist("names3", names);
      populateDatalist("names4", names);

      // Tab switching function
      function switchTab(tabName) {
        // Hide all tab contents
        const tabContents = document.querySelectorAll('.tab-content');
        tabContents.forEach(tab => tab.classList.remove('active'));

        // Remove active class from all buttons
        const tabButtons = document.querySelectorAll('.tab-button');
        tabButtons.forEach(button => button.classList.remove('active'));

        // Show selected tab
        document.getElementById(tabName).classList.add('active');

        // Add active class to clicked button
        event.target.classList.add('active');
      }

      // Sample Attendance Data
      const attendanceData = {};

      function viewAttendanceRecord() {
        const regimentalNo = document.getElementById("regimentalNo4").value.trim();
        const name = document.getElementById("name4").value.trim();
        const messageDiv = document.getElementById("message-viewAttendance");
        const attendanceTableDiv = document.getElementById("attendanceTable");
        const attendanceBody = document.getElementById("attendanceBody");

        messageDiv.innerHTML = "";
        attendanceTableDiv.style.display = "none";
        attendanceBody.innerHTML = "";

        if (!regimentalNo || !name) {
          messageDiv.innerHTML =
            "<span class='error'>⚠ Please enter Regimental No and Name!</span>";
          return;
        }

        if (attendanceData[name]) {
          attendanceBody.innerHTML = "";
          attendanceData[name].forEach(record => {
            const row = document.createElement("tr");
            row.innerHTML = `
              <td style="border: 1px solid #ddd; padding: 10px;">${record.date}</td>
              <td style="border: 1px solid #ddd; padding: 10px; color: ${record.status === 'Present' ? 'green' : 'red'}; font-weight: bold;">${record.status}</td>
              <td style="border: 1px solid #ddd; padding: 10px;">${record.event}</td>
            `;
            attendanceBody.appendChild(row);
          });
          attendanceTableDiv.style.display = "block";
          messageDiv.innerHTML =
            "<span class='success'>✔ Attendance records found</span>";
        } else {
          messageDiv.innerHTML =
            "<span class='error'>⚠ No attendance records found for this cadet!</span>";
        }
      }

      function submitForm(tabType) {
        // --- PASTE YOUR NEW GOOGLE SCRIPT URL BELOW ---
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzKxqnwLG9Qfje4cErhJ-46c6ORrRB6hVZDgQ1Ocsc3nEM1AhqFr_cMUqzqgPGHasOc/exec"; 
        
        let regimentalNo, rank, name, year, squadron, event, messageDiv;

        if (tabType === 'attendance') {
          regimentalNo = document.getElementById("regimentalNo2").value.trim();
          rank = document.getElementById("rank2").value.trim();
          name = document.getElementById("name2").value.trim();
          year = document.getElementById("year2").value;
          squadron = document.getElementById("squadron2").value;
          messageDiv = document.getElementById("message-attendance");
        } else if (tabType === 'event') {
          regimentalNo = document.getElementById("regimentalNo3").value.trim();
          rank = document.getElementById("rank3").value.trim();
          name = document.getElementById("name3").value.trim();
          year = document.getElementById("year3").value;
          squadron = document.getElementById("squadron3").value;
          event = document.getElementById("event3").value;
          messageDiv = document.getElementById("message-event");
        }

        // Validation
        messageDiv.innerHTML = ""; 
        if (tabType === 'attendance' && (!regimentalNo || !rank || !name || !year || !squadron)) {
          messageDiv.innerHTML = "<span class='error'>⚠ Please fill all fields!</span>";
          return;
        }
        if (tabType === 'event' && (!regimentalNo || !rank || !name || !year || !squadron || !event)) {
          messageDiv.innerHTML = "<span class='error'>⚠ Please fill all fields and select an event!</span>";
          return;
        }

        // Change button text to indicate loading
        messageDiv.innerHTML = "<span style='color:blue'>⏳ Submitting...</span>";

        const dataToSubmit = tabType === 'event' 
          ? { regimentalNo, rank, name, year, squadron, event, tabType }
          : { regimentalNo, rank, name, year, squadron, tabType };

        fetch(SCRIPT_URL, {
            method: "POST",
            mode: "no-cors", // distinct mode for Google Scripts
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(dataToSubmit),
          }
        )
        .then(() => {
          // Because of 'no-cors', we can't read the response, so we assume success if no network error.
          messageDiv.innerHTML = "<span class='success'>✔ Data Submitted Successfully!</span>";
          
          // Clear forms
          if (tabType === 'attendance') {
            document.getElementById("regimentalNo2").value = "";
            document.getElementById("rank2").value = "";
            document.getElementById("name2").value = "";
            document.getElementById("year2").value = "";
            document.getElementById("squadron2").value = "";
          } else if (tabType === 'event') {
            document.getElementById("regimentalNo3").value = "";
            document.getElementById("rank3").value = "";
            document.getElementById("name3").value = "";
            document.getElementById("year3").value = "";
            document.getElementById("squadron3").value = "";
            document.getElementById("event3").value = "";
          }
        })
        .catch((error) => {
          console.error("Error:", error);
          messageDiv.innerHTML = "<span class='error'>⚠ Error Submitting Data! Check Console.</span>";
        });
      }
    </script>
  </body>
</html>












